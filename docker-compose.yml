services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: hirepulse_user
      POSTGRES_PASSWORD: Admin@123
      POSTGRES_DB: hirepulse
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./uploads:/app/uploads # Mount uploads directory

  backend:
    build: .
    ports:
      - "8000:8000"
    environment:
      DATABASE_URL: postgresql+psycopg2://hirepulse_user:Admin%40123@postgres:5432/hirepulse
      SECRET_KEY: ${SECRET_KEY}
      NLP_MODELS_DIR: /app/nlp_models
      EMAIL_ENABLED: ${EMAIL_ENABLED:-true}
      EMAIL_FROM: ${EMAIL_FROM:-no-reply@hirepulse.com}
      SMTP_HOST: ${SMTP_HOST:-localhost}
      SMTP_PORT: ${SMTP_PORT:-25}
      SMTP_USER: ${SMTP_USER:-}
      SMTP_PASSWORD: ${SMTP_PASSWORD:-}
      SMTP_USE_TLS: ${SMTP_USE_TLS:-false}
    depends_on:
      - postgres
    volumes:
      - ./app:/app/app
      - ./uploads:/app/uploads # Persistent uploads
      - nlp_models:/app/nlp_models # Persistent NLP models

volumes:
  postgres_data:
  nlp_models:
